<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Estimate a Bayesian Dynamic Multivariate Panel Model — dynamite • dynamite</title><!-- rOpenSci favicons --><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="/apple-touch-icon.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><script src="../deps/MathJax-3.2.2/tex-chtml.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Estimate a Bayesian Dynamic Multivariate Panel Model — dynamite"><meta name="description" content="Fit a Bayesian dynamic multivariate panel model (DMPM) using Stan for
Bayesian inference. The dynamite package supports a wide range of
distributions and allows the user to flexibly customize the priors for the
model parameters. The dynamite model is specified using standard R formula
syntax via dynamiteformula(). For more information and examples,
see 'Details' and the package vignettes.
The formula method returns the model definition as a quoted expression.
Information on the estimated dynamite model can be obtained via
print() including the following: The model formula, the data,
the smallest effective sample sizes, largest Rhat and summary statistics of
the time-invariant and group-invariant model parameters.
The summary() method provides statistics of the posterior samples of the
model; this is an alias of as.data.frame.dynamitefit() with
summary = TRUE."><meta property="og:description" content="Fit a Bayesian dynamic multivariate panel model (DMPM) using Stan for
Bayesian inference. The dynamite package supports a wide range of
distributions and allows the user to flexibly customize the priors for the
model parameters. The dynamite model is specified using standard R formula
syntax via dynamiteformula(). For more information and examples,
see 'Details' and the package vignettes.
The formula method returns the model definition as a quoted expression.
Information on the estimated dynamite model can be obtained via
print() including the following: The model formula, the data,
the smallest effective sample sizes, largest Rhat and summary statistics of
the time-invariant and group-invariant model parameters.
The summary() method provides statistics of the posterior samples of the
model; this is an alias of as.data.frame.dynamitefit() with
summary = TRUE."><meta property="og:image" content="https://docs.ropensci.org/dynamite/logo.png"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/orestbida/cookieconsent@v3.0.0/dist/cookieconsent.css"><script src="https://cdn.jsdelivr.net/gh/orestbida/cookieconsent@v3.0.0/dist/cookieconsent.umd.js" data-cfasync="false"></script><script src="https://ropensci.org/scripts/matomo.js"></script><noscript><p><img src="https://ropensci.matomo.cloud/matomo.php?idsite=1&amp;rec=1" style="border:0;" alt=""></p></noscript></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">
    <a href="https://ropensci.org" class="external-link"><img src="https://ropensci.org/img/icon_short_white.svg" id="hexlogo" alt="rOpenSci"></a>
    <a class="navbar-brand me-2" href="../index.html">dynamite</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.5.4</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"></ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="nav-link" href="../articles/dynamite.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/dynamite_custom.html">Model customization and non-MCMC estimation with dynamite</a></li>
    <li><a class="dropdown-item" href="../articles/dynamite_priors.html">Priors for dynamic multivariate panel models</a></li>
    <li><a class="dropdown-item" href="../articles/dynamite_simulation.html">Simulating data from a dynamic multivariate panel model</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ropensci/dynamite/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Estimate a Bayesian Dynamic Multivariate Panel Model</h1>
      <small class="dont-index">Source: <a href="https://github.com/ropensci/dynamite/blob/master/R/dynamite.R" class="external-link"><code>R/dynamite.R</code></a>, <a href="https://github.com/ropensci/dynamite/blob/master/R/print.R" class="external-link"><code>R/print.R</code></a>, <a href="https://github.com/ropensci/dynamite/blob/master/R/summary.R" class="external-link"><code>R/summary.R</code></a></small>
      <div class="d-none name"><code>dynamite.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Fit a Bayesian dynamic multivariate panel model (DMPM) using Stan for
Bayesian inference. The <span class="pkg">dynamite</span> package supports a wide range of
distributions and allows the user to flexibly customize the priors for the
model parameters. The dynamite model is specified using standard <span style="R">R</span> formula
syntax via <code><a href="dynamiteformula.html">dynamiteformula()</a></code>. For more information and examples,
see 'Details' and the package vignettes.</p>
<p>The <code>formula</code> method returns the model definition as a quoted expression.</p>
<p>Information on the estimated <code>dynamite</code> model can be obtained via
<code><a href="https://rdrr.io/r/base/print.html" class="external-link">print()</a></code> including the following: The model formula, the data,
the smallest effective sample sizes, largest Rhat and summary statistics of
the time-invariant and group-invariant model parameters.</p>
<p>The <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> method provides statistics of the posterior samples of the
model; this is an alias of <code><a href="as.data.frame.dynamitefit.html">as.data.frame.dynamitefit()</a></code> with
<code>summary = TRUE</code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">dynamite</span><span class="op">(</span></span>
<span>  <span class="va">dformula</span>,</span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">time</span>,</span>
<span>  group <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  priors <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  backend <span class="op">=</span> <span class="st">"rstan"</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  verbose_stan <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  stanc_options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"O0"</span><span class="op">)</span>,</span>
<span>  threads_per_chain <span class="op">=</span> <span class="fl">1L</span>,</span>
<span>  grainsize <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  custom_stan_model <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  debug <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'dynamitefit'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/formula.html" class="external-link">formula</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'dynamitefit'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">x</span>, full_diagnostics <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'dynamitefit'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-dformula">dformula<a class="anchor" aria-label="anchor" href="#arg-dformula"></a></dt>
<dd><p>[<code>dynamiteformula</code>]<br> The model formula.
See <code><a href="dynamiteformula.html">dynamiteformula()</a></code> and 'Details'.</p></dd>


<dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>[<code>data.frame</code>, <code><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble::tibble</a></code>, or <code><a href="https://rdatatable.gitlab.io/data.table/reference/data.table.html" class="external-link">data.table::data.table</a></code>]<br>
The data that contains the variables in the model in long format.
Supported column types are <code>integer</code>, <code>logical</code>, <code>double</code>, and
<code>factor</code>. Columns of type <code>character</code> will be converted to factors.
Unused factor levels will be dropped. The <code>data</code> can contain missing
values which will simply be ignored in the estimation in a case-wise
fashion (per time-point and per channel). Input <code>data</code> is converted to
channel specific matrix representations via <code><a href="https://rdrr.io/r/stats/model.matrix.html" class="external-link">stats::model.matrix.lm()</a></code>.</p></dd>


<dt id="arg-time">time<a class="anchor" aria-label="anchor" href="#arg-time"></a></dt>
<dd><p>[<code>character(1)</code>]<br> A column name of <code>data</code> that denotes the
time index of observations. If this variable is a factor, the integer
representation of its levels are used internally for defining the time
indexing.</p></dd>


<dt id="arg-group">group<a class="anchor" aria-label="anchor" href="#arg-group"></a></dt>
<dd><p>[<code>character(1)</code>]<br> A column name of <code>data</code> that denotes the
unique groups or <code>NULL</code> corresponding to a scenario without any groups.
If <code>group</code> is <code>NULL</code>, a new column <code>.group</code> is created with constant
value <code>1L</code> is created indicating that all observations belong to the same
group. In case of name conflicts with <code>data</code>, see the <code>group_var</code> element
of the return object to get the column name of the new variable.</p></dd>


<dt id="arg-priors">priors<a class="anchor" aria-label="anchor" href="#arg-priors"></a></dt>
<dd><p>[<code>data.frame</code>]<br> An optional data frame with prior
definitions. See <code><a href="get_priors.html">get_priors()</a></code> and 'Details'.</p></dd>


<dt id="arg-backend">backend<a class="anchor" aria-label="anchor" href="#arg-backend"></a></dt>
<dd><p>[<code>character(1)</code>]<br> Defines the backend interface to Stan,
should be  either <code>"rstan"</code> (the default) or <code>"cmdstanr"</code>. Note that
<code>cmdstanr</code> needs to be installed separately as it is not on CRAN. It also
needs the actual <code>CmdStan</code> software. See <a href="https://mc-stan.org/cmdstanr/" class="external-link">https://mc-stan.org/cmdstanr/</a>
for details.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>[<code>logical(1)</code>]<br> All warnings and messages are suppressed
if set to <code>FALSE</code>. Defaults to <code>TRUE</code>. Setting this to <code>FALSE</code> will also
disable checks for perfect collinearity in the model matrix.</p></dd>


<dt id="arg-verbose-stan">verbose_stan<a class="anchor" aria-label="anchor" href="#arg-verbose-stan"></a></dt>
<dd><p>[<code>logical(1)</code>]<br> This is the <code>verbose</code> argument for
<code><a href="https://mc-stan.org/rstan/reference/stanmodel-method-sampling.html" class="external-link">rstan::sampling()</a></code>. Defaults to <code>FALSE</code>.</p></dd>


<dt id="arg-stanc-options">stanc_options<a class="anchor" aria-label="anchor" href="#arg-stanc-options"></a></dt>
<dd><p>[<code><a href="https://rdrr.io/r/base/list.html" class="external-link">list()</a></code>]<br> This is the <code>stanc_options</code> argument
passed to the compile method of a <code>CmdStanModel</code> object via
<code>cmdstan_model()</code> when <code>backend = "cmdstanr"</code>. Defaults to <code>list("O0")</code>.
To enable level one compiler optimizations, use <code>list("O1")</code>.
See <a href="https://mc-stan.org/cmdstanr/reference/cmdstan_model.html" class="external-link">https://mc-stan.org/cmdstanr/reference/cmdstan_model.html</a>
for details.</p></dd>


<dt id="arg-threads-per-chain">threads_per_chain<a class="anchor" aria-label="anchor" href="#arg-threads-per-chain"></a></dt>
<dd><p>[<code>integer(1)</code>]<br> A Positive integer defining the
number of parallel threads to use within each chain. Default is <code>1</code>. See
<code><a href="https://mc-stan.org/rstan/reference/rstan_options.html" class="external-link">rstan::rstan_options()</a></code> and
<a href="https://mc-stan.org/cmdstanr/reference/model-method-sample.html" class="external-link">https://mc-stan.org/cmdstanr/reference/model-method-sample.html</a>
for details.</p></dd>


<dt id="arg-grainsize">grainsize<a class="anchor" aria-label="anchor" href="#arg-grainsize"></a></dt>
<dd><p>[<code>integer(1)</code>]<br> A positive integer defining the
suggested size of the partial sums when using within-chain parallelization.
Default is number of time points divided by <code>threads_per_chain</code>.
Setting this to <code>1</code> leads the workload division entirely to the internal
scheduler. The performance of the within-chain parallelization can be
sensitive to the choice of <code>grainsize</code>, see Stan manual on reduce-sum for
details.</p></dd>


<dt id="arg-custom-stan-model">custom_stan_model<a class="anchor" aria-label="anchor" href="#arg-custom-stan-model"></a></dt>
<dd><p>[<code>character(1)</code>]<br> An optional character string
that either contains a customized Stan model code or a path to a <code>.stan</code>
file that contains the code. Using this will override the generated model
code. For expert users only.</p></dd>


<dt id="arg-debug">debug<a class="anchor" aria-label="anchor" href="#arg-debug"></a></dt>
<dd><p>[<code><a href="https://rdrr.io/r/base/list.html" class="external-link">list()</a></code>]<br> A named list of form <code>name = TRUE</code> indicating
additional objects in the environment of the <code>dynamite</code> function which are
added to the return object. Additionally, values <code>no_compile = TRUE</code> and
<code>no_sampling = TRUE</code> can be used to skip the compilation of the Stan code
and sampling steps respectively. This can be useful for debugging when
combined with <code>model_code = TRUE</code>, which adds the Stan model code to the
return object.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>For <code>dynamite()</code>, additional arguments to <code><a href="https://mc-stan.org/rstan/reference/stanmodel-method-sampling.html" class="external-link">rstan::sampling()</a></code> or
the <code>$sample()</code> method of the <code>CmdStanModel</code> object
(see <a href="https://mc-stan.org/cmdstanr/reference/model-method-sample.html" class="external-link">https://mc-stan.org/cmdstanr/reference/model-method-sample.html</a>),
such as <code>chains</code> and <code>cores</code>
(<code>chains</code> and <code>parallel_chains</code> in <code>cmdstanr</code>). For <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code>,
additional arguments to <code><a href="as.data.frame.dynamitefit.html">as.data.frame.dynamitefit()</a></code>. For <code><a href="https://rdrr.io/r/base/print.html" class="external-link">print()</a></code>,
further arguments to the print method for tibbles
(see <a href="https://tibble.tidyverse.org/reference/formatting.html" class="external-link">tibble::formatting</a>). Not used for <code><a href="https://rdrr.io/r/stats/formula.html" class="external-link">formula()</a></code>.</p></dd>


<dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>[<code>dynamitefit</code>]<br> The model fit object.</p></dd>


<dt id="arg-full-diagnostics">full_diagnostics<a class="anchor" aria-label="anchor" href="#arg-full-diagnostics"></a></dt>
<dd><p>By default, the effective sample size (ESS) and Rhat
are computed only for the time- and group-invariant parameters
(<code>full_diagnostics = FALSE</code>). Setting this to <code>TRUE</code> computes ESS and Rhat
values for all model parameters, which can take some time for complex models.</p></dd>


<dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p>[<code>dynamitefit</code>]<br> The model fit object.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p><code>dynamite</code> returns a <code>dynamitefit</code> object which is a list containing
the following components:</p><ul><li><p><code>stanfit</code><br> A <code>stanfit</code> object, see <code><a href="https://mc-stan.org/rstan/reference/stanmodel-method-sampling.html" class="external-link">rstan::sampling()</a></code> for details.</p></li>
<li><p><code>dformulas</code><br> A list of <code>dynamiteformula</code> objects for internal use.</p></li>
<li><p><code>data</code><br> A processed version of the input <code>data</code>.</p></li>
<li><p><code>data_name</code><br> Name of the input data object.</p></li>
<li><p><code>stan</code><br> A <code>list</code> containing various elements related to Stan model
construction and sampling.</p></li>
<li><p><code>group_var</code><br> Name of the variable defining the groups.</p></li>
<li><p><code>time_var</code><br> Name of the variable defining the time index.</p></li>
<li><p><code>priors</code><br> Data frame containing the used priors.</p></li>
<li><p><code>backend</code><br> Either <code>"rstan"</code> or <code>"cmdstanr"</code> indicating which
package was used in sampling.</p></li>
<li><p><code>permutation</code><br> Randomized permutation of the posterior draws.</p></li>
<li><p><code>call</code><br> Original function call as an object of class <code>call</code>.</p></li>
</ul><p><code>formula</code> returns a quoted expression.</p>
<p><code>print</code> returns <code>x</code> invisibly.</p>
<p><code>summary</code> returns a <code>data.frame</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The best-case scalability of <code>dynamite</code> in terms of data size should be
approximately linear in terms of number of time points and and number of
groups, but as wall-clock time of the MCMC algorithms provided by Stan can
depend on the discrepancy of the data and the model (and the subsequent
shape of the posterior), this can vary greatly.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Santtu Tikka and Jouni Helske (2023). <span class="pkg">dynamite</span>: An <span style="R">R</span> Package for
Dynamic Multivariate Panel Models. arXiv preprint,
<a href="https://arxiv.org/abs/2302.01607" class="external-link">https://arxiv.org/abs/2302.01607</a>.</p>
<p>Jouni Helske and Santtu Tikka (2022). Estimating Causal Effects
from Panel Data with Dynamic Multivariate Panel Models. SocArxiv preprint,
<a href="https://osf.io/preprints/socarxiv/mdwu5/" class="external-link">https://osf.io/preprints/socarxiv/mdwu5/</a>.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Model fitting
<code><a href="dynamice.html">dynamice</a>()</code>,
<code><a href="get_priors.html">get_priors</a>()</code>,
<code><a href="update.dynamitefit.html">update.dynamitefit</a>()</code></p>
<p>Model formula construction
<code><a href="dynamiteformula.html">dynamiteformula</a>()</code>,
<code><a href="lags.html">lags</a>()</code>,
<code><a href="lfactor.html">lfactor</a>()</code>,
<code><a href="random_spec.html">random_spec</a>()</code>,
<code><a href="splines.html">splines</a>()</code></p>
<p>Model outputs
<code><a href="as.data.frame.dynamitefit.html">as.data.frame.dynamitefit</a>()</code>,
<code><a href="as.data.table.dynamitefit.html">as.data.table.dynamitefit</a>()</code>,
<code><a href="as_draws-dynamitefit.html">as_draws_df.dynamitefit</a>()</code>,
<code><a href="coef.dynamitefit.html">coef.dynamitefit</a>()</code>,
<code><a href="confint.dynamitefit.html">confint.dynamitefit</a>()</code>,
<code><a href="get_code.html">get_code</a>()</code>,
<code><a href="get_data.html">get_data</a>()</code>,
<code><a href="get_parameter_dims.html">get_parameter_dims</a>()</code>,
<code><a href="get_parameter_names.html">get_parameter_names</a>()</code>,
<code><a href="get_parameter_types.html">get_parameter_types</a>()</code>,
<code><a href="ndraws.dynamitefit.html">ndraws.dynamitefit</a>()</code>,
<code><a href="nobs.dynamitefit.html">nobs.dynamitefit</a>()</code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu">data.table</span><span class="fu">::</span><span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/openmp-utils.html" class="external-link">setDTthreads</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span> <span class="co"># For CRAN</span></span></span>
<span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co"># Please update your rstan and StanHeaders installation before running</span></span></span>
<span class="r-in"><span><span class="co"># on Windows</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/identical.html" class="external-link">identical</a></span><span class="op">(</span><span class="va">.Platform</span><span class="op">$</span><span class="va">OS.type</span>, <span class="st">"windows"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu">dynamite</span><span class="op">(</span></span></span>
<span class="r-in"><span>    dformula <span class="op">=</span> <span class="fu"><a href="dynamiteformula.html">obs</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="op">-</span><span class="fl">1</span> <span class="op">+</span> <span class="fu">varying</span><span class="op">(</span><span class="op">~</span><span class="va">x</span><span class="op">)</span>, family <span class="op">=</span> <span class="st">"gaussian"</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>      <span class="fu"><a href="lags.html">lags</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"varying"</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>      <span class="fu"><a href="splines.html">splines</a></span><span class="op">(</span>df <span class="op">=</span> <span class="fl">20</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    <span class="va">gaussian_example</span>,</span></span>
<span class="r-in"><span>    <span class="st">"time"</span>,</span></span>
<span class="r-in"><span>    <span class="st">"id"</span>,</span></span>
<span class="r-in"><span>    chains <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    refresh <span class="op">=</span> <span class="fl">0</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">data.table</span><span class="fu">::</span><span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/openmp-utils.html" class="external-link">setDTthreads</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span> <span class="co"># For CRAN</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/formula.html" class="external-link">formula</a></span><span class="op">(</span><span class="va">gaussian_example_fit</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> obs(y ~ -1 + z + varying(~x + lag(y)) + random(~1), family = "gaussian") + </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     splines(df = 20, degree = 3, lb_tau = 0, noncentered = FALSE, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         override = FALSE) + random_spec(correlated = FALSE, noncentered = TRUE)</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">data.table</span><span class="fu">::</span><span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/openmp-utils.html" class="external-link">setDTthreads</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span> <span class="co"># For CRAN</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">gaussian_example_fit</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Family   Formula                                       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y gaussian y ~ -1 + z + varying(~x + lag(y)) + random(~1)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correlated random effects added for response(s): y</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Data: gaussian_example (Number of observations: 1450)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Grouping variable: id (Number of groups: 50)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Time index variable: time (Number of time points: 30)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NUTS sampler diagnostics:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> No divergences, saturated max treedepths or low E-BFMIs.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Smallest bulk-ESS: 178 (sigma_y)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Smallest tail-ESS: 156 (tau_alpha_y)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Largest Rhat: 1.018 (beta_y_z)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Elapsed time (seconds):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         warmup sample</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> chain:1  6.313  3.086</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> chain:2  6.472  3.322</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Summary statistics of the time- and group-invariant parameters:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 6 × 10</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   variable      mean median      sd     mad     q5   q95  rhat ess_bulk ess_tail</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> beta_y_z    1.97   1.97   0.011<span style="text-decoration: underline;">2</span>  0.011<span style="text-decoration: underline;">3</span>  1.95   1.98  1.02      230.     175.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> sigma_nu_y… 0.095<span style="text-decoration: underline;">5</span> 0.094<span style="text-decoration: underline;">0</span> 0.011<span style="text-decoration: underline;">7</span>  0.010<span style="text-decoration: underline;">3</span>  0.079<span style="text-decoration: underline;">1</span> 0.120 1.00      195.     157.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span> sigma_y     0.198  0.198  0.004<span style="text-decoration: underline;">04</span> 0.004<span style="text-decoration: underline;">01</span> 0.192  0.205 0.995     178.     188.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span> tau_alpha_y 0.200  0.193  0.046<span style="text-decoration: underline;">3</span>  0.044<span style="text-decoration: underline;">0</span>  0.139  0.283 0.999     211.     156.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">5</span> tau_y_x     0.364  0.348  0.077<span style="text-decoration: underline;">0</span>  0.074<span style="text-decoration: underline;">6</span>  0.253  0.497 1.01      198.     187.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">6</span> tau_y_y_la… 0.105  0.102  0.020<span style="text-decoration: underline;">8</span>  0.019<span style="text-decoration: underline;">5</span>  0.076<span style="text-decoration: underline;">4</span> 0.140 1.01      231.     186.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">data.table</span><span class="fu">::</span><span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/openmp-utils.html" class="external-link">setDTthreads</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span> <span class="co"># For CRAN</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">gaussian_example_fit</span>,</span></span>
<span class="r-in"><span>  types <span class="op">=</span> <span class="st">"beta"</span>,</span></span>
<span class="r-in"><span>  probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">0.1</span>, <span class="fl">0.9</span>, <span class="fl">0.95</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 1 × 12</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   parameter  mean     sd    q5   q10   q90   q95  time group category response</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> beta_y_z   1.97 0.011<span style="text-decoration: underline;">2</span>  1.95  1.95  1.98  1.98    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span> <span style="color: #BB0000;">NA</span>       y       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 1 more variable: type &lt;chr&gt;</span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><!-- begin footer --><div class="footer">
    <div class="container">
        <div class="row start top-4 bottom-8">
            <div class="col-2"> <img id="footerlogo" src="https://ropensci.org/img/icon_short_white.svg"></div>
            <div class="col-10">
                <div class="row">
                    <div class="col-md-4 col-xs-6">
                        <a href="https://github.com/ropensci" target="_blank" class="external-link"><div class="icon fab fa-github"></div></a>
                        <a href="https://github.com/ropenscilabs" target="_blank" class="external-link"><div class="icon fa fa-flask"></div></a>
                        <a href="https://hachyderm.io/@ropensci" target="_blank" class="external-link"><div class="icon fab fa-mastodon"></div></a>
                        <a href="https://vimeo.com/ropensci" target="_blank" class="external-link"><div class="icon fab fa-vimeo"></div></a>
                    </div>
                </div>
                <div class="row top-4">
                    <div class="col-md-2 col-sm-4">
                        <ul><h5 class="bottom-2">About</h5>
                            <li><a href="https://ropensci.org/about" class="external-link">About rOpenSci</a></li>
                            <li><a href="https://ropensci.org/software-review" class="external-link">Software Review</a></li>
                            <li><a href="https://ropensci.org/about#team" class="external-link">Our Team</a></li>
                            <li><a href="https://ropensci.org/careers" class="external-link">Jobs</a></li>
                            <li><a href="https://ropensci.org/donate" class="external-link">Donate</a></li>
                            <li><a href="https://ropensci.org/contact" class="external-link">Contact Us</a></li>
                        </ul></div>
                    <div class="col-md-3 col-sm-4">
                        <ul><h5 class="bottom-2">Community</h5>
                            <li><a href="https://ropensci.org/community/" class="external-link">Our Community</a></li>
                            <li><a href="https://ropensci.org/commcalls/" class="external-link">Community calls</a></li>
                            <li><a href="https://ropensci.org/events/" class="external-link">Events</a></li>
                            <li><a href="https://discuss.ropensci.org/" class="external-link">Join the Discussion</a></li>
                            <li><a href="https://ropensci.org/code-of-conduct" class="external-link">Code of conduct</a></li>
                        </ul></div>
                    <div class="col-md-2 col-sm-4">
                        <ul><h5 class="bottom-2">Resources</h5>
                            <li><a href="https://ropensci.org/packages/" class="external-link">Packages</a></li>
                            <li><a href="https://ropensci.org/usecases/" class="external-link">Use Cases</a></li>
                            <li><a href="https://ropensci.org/talks-papers/" class="external-link">Talks &amp; Publications</a></li>
                            <li><a href="https://docs.ropensci.org/" class="external-link">Documentation</a></li>
                            <li><a href="https://ropensci.org/news/" class="external-link">Newsletter</a></li>
                            <li><a href="https://ropensci.org/how-to-cite-ropensci/" class="external-link">Cite rOpenSci</a></li>
                        </ul></div>
                    <div class="col-md-4 col-xs-12">
                        <h5 class="bottom-2"></h5>

                        <p>rOpenSci is a fiscally sponsored project of <a href="http://numfocus.org" class="external-link">NumFOCUS</a>.</p>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- / end footer -->


    </footer></div>





  </body></html>

