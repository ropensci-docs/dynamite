<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Model Formula for dynamite — dynamiteformula • dynamite</title><!-- rOpenSci favicons --><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="/apple-touch-icon.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><script src="../deps/MathJax-3.2.2/tex-chtml.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Model Formula for dynamite — dynamiteformula"><meta name="description" content="Defines a new observational or a new auxiliary channel for the model using
standard R formula syntax. Formulas of individual response variables can be
joined together via +. See 'Details' and the package vignettes for more
information. The function obs is a shorthand alias for dynamiteformula,
and aux is a shorthand alias for
dynamiteformula(formula, family = &quot;deterministic&quot;)."><meta property="og:description" content="Defines a new observational or a new auxiliary channel for the model using
standard R formula syntax. Formulas of individual response variables can be
joined together via +. See 'Details' and the package vignettes for more
information. The function obs is a shorthand alias for dynamiteformula,
and aux is a shorthand alias for
dynamiteformula(formula, family = &quot;deterministic&quot;)."><meta property="og:image" content="https://docs.ropensci.org/dynamite/logo.png"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/orestbida/cookieconsent@v3.0.0/dist/cookieconsent.css"><script src="https://cdn.jsdelivr.net/gh/orestbida/cookieconsent@v3.0.0/dist/cookieconsent.umd.js" data-cfasync="false"></script><script src="https://ropensci.org/scripts/matomo.js"></script><noscript><p><img src="https://ropensci.matomo.cloud/matomo.php?idsite=1&amp;rec=1" style="border:0;" alt=""></p></noscript></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">
    <a href="https://ropensci.org" class="external-link"><img src="https://ropensci.org/img/icon_short_white.svg" id="hexlogo" alt="rOpenSci"></a>
    <a class="navbar-brand me-2" href="../index.html">dynamite</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.5.4</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"></ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="nav-link" href="../articles/dynamite.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/dynamite_custom.html">Model customization and non-MCMC estimation with dynamite</a></li>
    <li><a class="dropdown-item" href="../articles/dynamite_priors.html">Priors for dynamic multivariate panel models</a></li>
    <li><a class="dropdown-item" href="../articles/dynamite_simulation.html">Simulating data from a dynamic multivariate panel model</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ropensci/dynamite/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Model Formula for <span class="pkg">dynamite</span></h1>
      <small class="dont-index">Source: <a href="https://github.com/ropensci/dynamite/blob/master/R/dynamiteformula.R" class="external-link"><code>R/dynamiteformula.R</code></a></small>
      <div class="d-none name"><code>dynamiteformula.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Defines a new observational or a new auxiliary channel for the model using
standard <span style="R">R</span> formula syntax. Formulas of individual response variables can be
joined together via <code>+</code>. See 'Details' and the package vignettes for more
information. The function <code>obs</code> is a shorthand alias for <code>dynamiteformula</code>,
and <code>aux</code> is a shorthand alias for
<code>dynamiteformula(formula, family = "deterministic")</code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">dynamiteformula</span><span class="op">(</span><span class="va">formula</span>, <span class="va">family</span>, link <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">obs</span><span class="op">(</span><span class="va">formula</span>, <span class="va">family</span>, link <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">aux</span><span class="op">(</span><span class="va">formula</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'dynamiteformula'</span></span>
<span><span class="va">e1</span> <span class="op">+</span> <span class="va">e2</span></span>
<span></span>
<span><span class="co"># S3 method for class 'dynamiteformula'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-formula">formula<a class="anchor" aria-label="anchor" href="#arg-formula"></a></dt>
<dd><p>[<code>formula</code>]<br> An <span style="R">R</span> formula describing the model.</p></dd>


<dt id="arg-family">family<a class="anchor" aria-label="anchor" href="#arg-family"></a></dt>
<dd><p>[<code>character(1)</code>]<br> The family name. See 'Details' for the
supported families.</p></dd>


<dt id="arg-link">link<a class="anchor" aria-label="anchor" href="#arg-link"></a></dt>
<dd><p>[<code>character(1)</code>]<br> The name of the link function to use or
<code>NULL</code>. See details for supported link functions and default values of
specific families.</p></dd>


<dt id="arg-e-">e1<a class="anchor" aria-label="anchor" href="#arg-e-"></a></dt>
<dd><p>[<code>dynamiteformula</code>]<br> A model formula specification.</p></dd>


<dt id="arg-e-">e2<a class="anchor" aria-label="anchor" href="#arg-e-"></a></dt>
<dd><p>[<code>dynamiteformula</code>]<br> A model formula specification.</p></dd>


<dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>[<code>dynamiteformula</code>]<br> The model formula.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Ignored.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A <code>dynamiteformula</code> object.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Currently the <span class="pkg">dynamite</span> package supports the following
distributions for the observations:</p><ul><li><p>Categorical: <code>categorical</code> (with a softmax link using the first category
as reference). See the documentation of the <code>categorical_logit_glm</code> in the
Stan function reference manual <a href="https://mc-stan.org/users/documentation/" class="external-link">https://mc-stan.org/users/documentation/</a>.</p></li>
<li><p>Multinomial: <code>multinomial</code> (softmax link, first category is reference).</p></li>
<li><p>Gaussian: <code>gaussian</code> (identity link, parameterized using mean and standard
deviation).</p></li>
<li><p>Multivariate Gaussian: <code>mvgaussian</code> (identity link, parameterized using
mean vector, standard deviation vector and the Cholesky decomposition of
the correlation matrix).</p></li>
<li><p>Poisson: <code>poisson</code> (log-link, with an optional known offset variable).</p></li>
<li><p>Negative-binomial: <code>negbin</code> (log-link, using mean and dispersion
parameterization, with an optional known offset variable). See the
documentation on <code>NegBinomial2</code> in the Stan function reference manual.</p></li>
<li><p>Bernoulli: <code>bernoulli</code> (logit-link).</p></li>
<li><p>Binomial: <code>binomial</code> (logit-link).</p></li>
<li><p>Exponential: <code>exponential</code> (log-link).</p></li>
<li><p>Gamma: <code>gamma</code> (log-link, using mean and shape parameterization).</p></li>
<li><p>Beta: <code>beta</code> (logit-link, using mean and precision parameterization).</p></li>
<li><p>Student t: <code>student</code> (identity link, parameterized using degrees of
freedom, location and scale)</p></li>
</ul><p>The models in the <span class="pkg">dynamite</span> package are defined by combining the
channel-specific formulas defined via <span style="R">R</span> formula syntax.
Each channel is defined via the <code>obs</code> function, and the channels are
combined with <code>+</code>. For example a formula
<code>obs(y ~ lag(x), family = "gaussian") + obs(x ~ z, family = "poisson")</code>
defines a model with two channels;
first we declare that <code>y</code> is a Gaussian variable depending on a previous
value of <code>x</code> (<code>lag(x)</code>), and then we add a second channel declaring <code>x</code> as
Poisson distributed depending on some exogenous variable <code>z</code>
(for which we do not define any distribution).</p>
<p>Number of trials for binomial channels should be defined via a <code>trials</code>
model component, e.g., <code>obs(y ~ x + trials(n), family = "binomial")</code>,
where <code>n</code> is a data variable defining the number of trials. For multinomial
channels, the number of trials is automatically defined to be the sum
of the observations over the categories, but can also be defined using
the <code>trials</code> component, for example for prediction.</p>
<p>Multivariate channels are defined by providing a single formula for all
components or by providing component-specific formulas separated by a <code>|</code>.
The response variables that correspond to the components should be joined by
<code><a href="https://rdrr.io/r/base/c.html" class="external-link">c()</a></code>. For instance, the following would define <code>c(y1, y2)</code> as multivariate
gaussian with <code>x</code> as a predictor for the mean of the first component and
<code>x</code> and <code>z</code> as predictors for the mean of the second component:
<code>obs(c(y1, y2) ~ x | x + z, family = "mvgaussian")</code>. A multinomial channel
should only have a single formula.</p>
<p>In addition to declaring response variables via <code>obs</code>, we can also use
the function <code>aux</code> to define auxiliary channels which are deterministic
functions of other variables. The values of auxiliary variables are computed
dynamically during prediction, making the use of lagged values and other
transformations possible. The function <code>aux</code> also does not use the
<code>family</code> argument, which is automatically set to <code>deterministic</code> and is a
special channel type of <code>obs</code>. Note that lagged values of deterministic
<code>aux</code> channels do not imply fixed time points. Instead they must be given
starting values using a special function <code>init</code> that directly initializes
the lags to specified values, or by <code>past</code> which computes the initial values
based on an R expression. Both <code>init</code> and <code>past</code> should appear on the
right hand side of the model formula, separated from the primary defining
expression via <code>|</code>.</p>
<p>The formula within <code>obs</code> can also contain an additional special
function <code>varying</code>, which defines the time-varying part of the model
equation, in which case we could write for example
<code>obs(x ~ z + varying(~ -1 + w), family = "poisson")</code>, which defines a model
equation with a constant intercept and time-invariant effect of <code>z</code>, and a
time-varying effect of <code>w</code>. We also remove the duplicate intercept with <code>-1</code>
in order to avoid identifiability issues in the model estimation
(we could also define a time varying intercept, in which case we would write
<code>obs(x ~ -1 + z + varying(~ w), family = "poisson)</code>). The part of the formula
not wrapped with <code>varying</code> is assumed to correspond to the fixed part of the
model, so <code>obs(x ~ z + varying(~ -1 + w), family = "poisson")</code> is actually
identical to
<code>obs(x ~ -1 + fixed(~ z) + varying(~ -1 + w), family = "poisson")</code> and
<code>obs(x ~ fixed(~ z) + varying(~ -1 + w), family = "poisson")</code>.</p>
<p>When defining varying effects, we also need to define how the these
time-varying regression coefficient behave. For this, a <code>splines</code> component
should be added to the model, e.g.,
<code>obs(x ~ varying(~ -1 + w), family = "poisson) + splines(df = 10)</code> defines a
cubic B-spline with 10 degrees of freedom for the time-varying coefficient
corresponding to the <code>w</code>. If the model contains multiple time-varying
coefficients, same spline basis is used for all coefficients, with unique
spline coefficients and their standard deviation.</p>
<p>If the desired model contains lagged predictors of each response in each
channel, these can be quickly added to the model as either time-invariant
or time-varying predictors via <code><a href="lags.html">lags()</a></code> instead of writing them manually
for each channel.</p>
<p>It is also possible to define group-specific (random) effects term
using the special syntax <code>random()</code> similarly as <code>varying()</code>. For example,
<code>random(~1)</code> leads to a model where in addition to the common intercept,
each individual/group has their own intercept with zero-mean normal prior and
unknown standard deviation analogously with the typical mixed models. An
additional model component <code><a href="random_spec.html">random_spec()</a></code> can be used to define
whether the random effects are allowed to correlate within and across
channels and whether to use centered or noncentered parameterization for
the random effects.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Model formula construction
<code><a href="dynamite.html">dynamite</a>()</code>,
<code><a href="lags.html">lags</a>()</code>,
<code><a href="lfactor.html">lfactor</a>()</code>,
<code><a href="random_spec.html">random_spec</a>()</code>,
<code><a href="splines.html">splines</a>()</code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu">data.table</span><span class="fu">::</span><span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/openmp-utils.html" class="external-link">setDTthreads</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span> <span class="co"># For CRAN</span></span></span>
<span class="r-in"><span><span class="co"># A single gaussian response channel with a time-varying effect of 'x',</span></span></span>
<span class="r-in"><span><span class="co"># and a time-varying effect of the lag of 'y' using B-splines with</span></span></span>
<span class="r-in"><span><span class="co"># 20 degrees of freedom for the coefficients of the time-varying terms.</span></span></span>
<span class="r-in"><span><span class="fu">obs</span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="op">-</span><span class="fl">1</span> <span class="op">+</span> <span class="fu">varying</span><span class="op">(</span><span class="op">~</span><span class="va">x</span><span class="op">)</span>, family <span class="op">=</span> <span class="st">"gaussian"</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="lags.html">lags</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"varying"</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="splines.html">splines</a></span><span class="op">(</span>df <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Family   Formula             </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y gaussian y ~ -1 + varying(~x)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Lagged responses added as varying predictors with: k = 1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># A two-channel categorical model with time-invariant predictors</span></span></span>
<span class="r-in"><span><span class="co"># here, lag terms are specified manually</span></span></span>
<span class="r-in"><span><span class="fu">obs</span><span class="op">(</span><span class="va">x</span> <span class="op">~</span> <span class="va">z</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/lag.html" class="external-link">lag</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/lag.html" class="external-link">lag</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>, family <span class="op">=</span> <span class="st">"categorical"</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu">obs</span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">z</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/lag.html" class="external-link">lag</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/lag.html" class="external-link">lag</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>, family <span class="op">=</span> <span class="st">"categorical"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Family      Formula                </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x categorical x ~ z + lag(x) + lag(y)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y categorical y ~ z + lag(x) + lag(y)</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># The same categorical model as above, but with the lag terms</span></span></span>
<span class="r-in"><span><span class="co"># added using 'lags'</span></span></span>
<span class="r-in"><span><span class="fu">obs</span><span class="op">(</span><span class="va">x</span> <span class="op">~</span> <span class="va">z</span>, family <span class="op">=</span> <span class="st">"categorical"</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu">obs</span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">z</span>, family <span class="op">=</span> <span class="st">"categorical"</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="lags.html">lags</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"fixed"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Family      Formula</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x categorical x ~ z  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y categorical y ~ z  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Lagged responses added as fixed predictors with: k = 1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># A multichannel model with a gaussian, Poisson and a Bernoulli response and</span></span></span>
<span class="r-in"><span><span class="co"># an auxiliary channel for the logarithm of 'p' plus one</span></span></span>
<span class="r-in"><span><span class="fu">obs</span><span class="op">(</span><span class="va">g</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/lag.html" class="external-link">lag</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/lag.html" class="external-link">lag</a></span><span class="op">(</span><span class="va">logp</span><span class="op">)</span>, family <span class="op">=</span> <span class="st">"gaussian"</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu">obs</span><span class="op">(</span><span class="va">p</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/lag.html" class="external-link">lag</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/lag.html" class="external-link">lag</a></span><span class="op">(</span><span class="va">logp</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/lag.html" class="external-link">lag</a></span><span class="op">(</span><span class="va">b</span><span class="op">)</span>, family <span class="op">=</span> <span class="st">"poisson"</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu">obs</span><span class="op">(</span><span class="va">b</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/lag.html" class="external-link">lag</a></span><span class="op">(</span><span class="va">b</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/lag.html" class="external-link">lag</a></span><span class="op">(</span><span class="va">logp</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/lag.html" class="external-link">lag</a></span><span class="op">(</span><span class="va">b</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/lag.html" class="external-link">lag</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span>, family <span class="op">=</span> <span class="st">"bernoulli"</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu">aux</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="va">logp</span><span class="op">)</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">p</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Family        Formula                                 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> g    gaussian      g ~ lag(g) + lag(logp)                  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> p    poisson       p ~ lag(g) + lag(logp) + lag(b)         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b    bernoulli     b ~ lag(b) * lag(logp) + lag(b) * lag(g)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> logp deterministic numeric(logp) ~ log(p + 1)              </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">data.table</span><span class="fu">::</span><span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/openmp-utils.html" class="external-link">setDTthreads</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span> <span class="co"># For CRAN</span></span></span>
<span class="r-in"><span><span class="fu">obs</span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x</span>, family <span class="op">=</span> <span class="st">"gaussian"</span><span class="op">)</span> <span class="op">+</span> <span class="fu">obs</span><span class="op">(</span><span class="va">z</span> <span class="op">~</span> <span class="va">w</span>, family <span class="op">=</span> <span class="st">"exponential"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Family      Formula</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y gaussian    y ~ x  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> z exponential z ~ w  </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">data.table</span><span class="fu">::</span><span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/openmp-utils.html" class="external-link">setDTthreads</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span> <span class="co"># For CRAN</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">obs</span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x</span> <span class="op">+</span> <span class="fu">random</span><span class="op">(</span><span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/lag.html" class="external-link">lag</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span><span class="op">)</span>, family <span class="op">=</span> <span class="st">"gaussian"</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu">obs</span><span class="op">(</span><span class="va">z</span> <span class="op">~</span> <span class="fu">varying</span><span class="op">(</span><span class="op">~</span><span class="va">w</span><span class="op">)</span>, family <span class="op">=</span> <span class="st">"exponential"</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu">aux</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span> <span class="op">|</span> <span class="fu">init</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="lags.html">lags</a></span><span class="op">(</span>k <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="splines.html">splines</a></span><span class="op">(</span>df <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="random_spec.html">random_spec</a></span><span class="op">(</span>correlated <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Both time-constant and time-varying intercept specified:</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Defaulting to time-varying intercept.</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Family        Formula                            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y gaussian      y ~ x + random(~1 + lag(d))        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> z exponential   z ~ varying(~w)                    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> d deterministic numeric(d) ~ log(y) | init(c(0, 1))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Lagged responses added as fixed predictors with: k = 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Random effects added for response(s): y</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><!-- begin footer --><div class="footer">
    <div class="container">
        <div class="row start top-4 bottom-8">
            <div class="col-2"> <img id="footerlogo" src="https://ropensci.org/img/icon_short_white.svg"></div>
            <div class="col-10">
                <div class="row">
                    <div class="col-md-4 col-xs-6">
                        <a href="https://github.com/ropensci" target="_blank" class="external-link"><div class="icon fab fa-github"></div></a>
                        <a href="https://github.com/ropenscilabs" target="_blank" class="external-link"><div class="icon fa fa-flask"></div></a>
                        <a href="https://hachyderm.io/@ropensci" target="_blank" class="external-link"><div class="icon fab fa-mastodon"></div></a>
                        <a href="https://vimeo.com/ropensci" target="_blank" class="external-link"><div class="icon fab fa-vimeo"></div></a>
                    </div>
                </div>
                <div class="row top-4">
                    <div class="col-md-2 col-sm-4">
                        <ul><h5 class="bottom-2">About</h5>
                            <li><a href="https://ropensci.org/about" class="external-link">About rOpenSci</a></li>
                            <li><a href="https://ropensci.org/software-review" class="external-link">Software Review</a></li>
                            <li><a href="https://ropensci.org/about#team" class="external-link">Our Team</a></li>
                            <li><a href="https://ropensci.org/careers" class="external-link">Jobs</a></li>
                            <li><a href="https://ropensci.org/donate" class="external-link">Donate</a></li>
                            <li><a href="https://ropensci.org/contact" class="external-link">Contact Us</a></li>
                        </ul></div>
                    <div class="col-md-3 col-sm-4">
                        <ul><h5 class="bottom-2">Community</h5>
                            <li><a href="https://ropensci.org/community/" class="external-link">Our Community</a></li>
                            <li><a href="https://ropensci.org/commcalls/" class="external-link">Community calls</a></li>
                            <li><a href="https://ropensci.org/events/" class="external-link">Events</a></li>
                            <li><a href="https://discuss.ropensci.org/" class="external-link">Join the Discussion</a></li>
                            <li><a href="https://ropensci.org/code-of-conduct" class="external-link">Code of conduct</a></li>
                        </ul></div>
                    <div class="col-md-2 col-sm-4">
                        <ul><h5 class="bottom-2">Resources</h5>
                            <li><a href="https://ropensci.org/packages/" class="external-link">Packages</a></li>
                            <li><a href="https://ropensci.org/usecases/" class="external-link">Use Cases</a></li>
                            <li><a href="https://ropensci.org/talks-papers/" class="external-link">Talks &amp; Publications</a></li>
                            <li><a href="https://docs.ropensci.org/" class="external-link">Documentation</a></li>
                            <li><a href="https://ropensci.org/news/" class="external-link">Newsletter</a></li>
                            <li><a href="https://ropensci.org/how-to-cite-ropensci/" class="external-link">Cite rOpenSci</a></li>
                        </ul></div>
                    <div class="col-md-4 col-xs-12">
                        <h5 class="bottom-2"></h5>

                        <p>rOpenSci is a fiscally sponsored project of <a href="http://numfocus.org" class="external-link">NumFOCUS</a>.</p>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- / end footer -->


    </footer></div>





  </body></html>

